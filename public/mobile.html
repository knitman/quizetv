<!DOCTYPE html>
<html lang="el">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Î— Î“ÎÎ©Î£Î— Î•Î™ÎÎ‘Î™ ÎÎ™ÎšÎ—</title>

<style>
html, body {
  width:100%; height:100%; margin:0;
  background: radial-gradient(circle at top, #0b2c5d, #020b1c);
  color: gold; font-family: Arial; text-align:center;
}
.screen {
  position:absolute; inset:0;
  display:flex; flex-direction:column;
  justify-content:center; align-items:center;
}
.hidden { display:none; }
#icon { width:140px; margin-bottom:20px; }
input {
  width:80%; padding:14px; font-size:18px;
  border-radius:30px; border:none; text-align:center;
}
button {
  margin-top:16px; padding:16px 44px;
  font-size:20px; border:none; border-radius:40px;
  background:linear-gradient(135deg,gold,#ffec8b);
}
</style>
</head>

<body>

<div id="joinScreen" class="screen">
  <img id="icon" src="icon.png">
  <input id="name" placeholder="ÎŒÎ½Î¿Î¼Î±">
  <button onclick="join()">ÎœÎ Î•Î£</button>
</div>

<div id="readyScreen" class="screen hidden">
  <img id="icon" src="icon.png">
  <button onclick="ready()">Î•Î¤ÎŸÎ™ÎœÎŸÎ£</button>
  <div id="status"></div>
</div>

<div id="gameScreen" class="screen hidden">
  <button onclick="send(0)">ğŸ…° Î‘</button>
  <button onclick="send(1)">ğŸ…± Î’</button>
  <button onclick="send(2)">ğŸ…² Î“</button>
  <button onclick="send(3)">ğŸ…³ Î”</button>
  <div id="statusGame"></div>
</div>

<script>
let ws;
let socketReady = false;
let pendingReady = false;
let answered = false;

function connectWS() {
  ws = new WebSocket(
    (location.protocol==="https:"?"wss://":"ws://")+location.host
  );

  ws.onopen = () => {
    socketReady = true;
    if (pendingReady) {
      ws.send(JSON.stringify({ type:"ready" }));
      pendingReady = false;
    }
  };

  ws.onmessage = e => {
    const d = JSON.parse(e.data);
    if (d.type === "question") {
      answered = false;
      statusGame.textContent = "Î‘Î Î‘ÎÎ¤Î—Î£Î• Î¤Î©Î¡Î‘!";
    }
    if (d.type === "countdown") {
      status.textContent = "ÎÎµÎºÎ¹Î½Î¬ ÏƒÎµ " + d.seconds;
    }
  };
}

connectWS();

function join(){
  const name = document.getElementById("name").value.trim();
  if(!name) return alert("Î’Î¬Î»Îµ ÏŒÎ½Î¿Î¼Î±");

  ws.send(JSON.stringify({ type:"join", name }));
  joinScreen.classList.add("hidden");
  readyScreen.classList.remove("hidden");
}

function ready(){
  if (!socketReady) {
    pendingReady = true;
    status.textContent = "Î£Ï…Î½Î´Î­ÎµÏ„Î±Î¹â€¦";
    return;
  }

  ws.send(JSON.stringify({ type:"ready" }));
  readyScreen.classList.add("hidden");
  gameScreen.classList.remove("hidden");
  statusGame.textContent = "Î ÎµÏÎ¹Î¼Î­Î½Î¿Ï…Î¼Îµ Î½Î± Î¾ÎµÎºÎ¹Î½Î®ÏƒÎµÎ¹â€¦";
}

function send(a){
  if(answered) return;
  answered = true;
  ws.send(JSON.stringify({ type:"answer", answer:a }));
  statusGame.textContent = "Î‘Ï€Î¬Î½Ï„Î·ÏƒÎ· ÏƒÏ„Î¬Î»Î¸Î·ÎºÎµ âœ“";
}
</script>

</body>
</html>
